!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.GunnSchedule=t():e.GunnSchedule=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){const n=r(1),{defaultSelf:s}=r(2),o=[[],[{period:n.A,start:505,end:585},{period:n.BRUNCH,start:585,end:590},{period:n.B,start:600,end:675},{period:n.C,start:685,end:760},{period:n.LUNCH,start:760,end:790},{period:n.F,start:800,end:875}],[{period:n.D,start:505,end:585},{period:n.BRUNCH,start:585,end:590},{period:n.FLEX,start:600,end:650},{period:n.E,start:660,end:735},{period:n.LUNCH,start:735,end:765},{period:n.A,start:775,end:855},{period:n.G,start:865,end:940}],[{period:n.B,start:505,end:590},{period:n.BRUNCH,start:590,end:595},{period:n.C,start:605,end:685},{period:n.D,start:695,end:775},{period:n.LUNCH,start:775,end:805},{period:n.F,start:815,end:895}],[{period:n.E,start:505,end:590},{period:n.BRUNCH,start:590,end:595},{period:n.SELF,start:605,end:655,selfGrades:s},{period:n.B,start:665,end:735},{period:n.LUNCH,start:735,end:765},{period:n.A,start:775,end:845},{period:n.G,start:855,end:935}],[{period:n.C,start:505,end:580},{period:n.BRUNCH,start:580,end:585},{period:n.D,start:595,end:665},{period:n.E,start:675,end:745},{period:n.LUNCH,start:745,end:775},{period:n.F,start:785,end:855},{period:n.G,start:865,end:935}],[]],i=[[],[{period:n.A,start:600,end:630},{period:n.B,start:640,end:670},{period:n.C,start:680,end:710},{period:n.D,start:720,end:755},{period:n.LUNCH,start:755,end:785},{period:n.E,start:795,end:825},{period:n.F,start:835,end:865},{period:n.G,start:875,end:905}],[{period:n.A,start:540,end:615},{period:n.B,start:625,end:700},{period:n.LUNCH,start:700,end:730},{period:n.C,start:740,end:820},{period:n.D,start:830,end:905},{period:n.FLEX,start:910,end:940}],[{period:n.E,start:580,end:655},{period:n.GT,start:665,end:700},{period:n.LUNCH,start:700,end:730},{period:n.F,start:740,end:820},{period:n.G,start:830,end:905},{period:n.FLEX,start:910,end:940}],[{period:n.A,start:540,end:615},{period:n.B,start:625,end:700},{period:n.LUNCH,start:700,end:730},{period:n.C,start:740,end:820},{period:n.D,start:830,end:905},{period:n.FLEX,start:910,end:940}],[{period:n.E,start:580,end:655},{period:n.SELF,start:665,end:700,selfGrades:15},{period:n.LUNCH,start:700,end:730},{period:n.F,start:740,end:820},{period:n.G,start:830,end:905}],[]];e.exports={schedule1920:o,schedule2021:i}},function(e,t){e.exports={ZERO:"0",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",1:"A",2:"B",3:"C",4:"D",5:"E",6:"F",7:"G",BRUNCH:"b",LUNCH:"l",FLEX:"f",SELF:"s",MEETINGS:"m",COLLABORATION:"c",GT:"g"}},function(e,t){e.exports={PASSING_PERIOD_LENGTH:10,defaultSelf:7,newLineRegex:/\r?\n/g,KEYWORDS:["self","schedule","extended","holiday","no students","no school","break","development"],TIME_ZONE_OFFSET:-7,CALENDAR_ID:"u5mgb2vlddfj70d7frf3r015h0@group.calendar.google.com"}},function(e,t,r){const n=r(9),s=[9,10,11,12];e.exports=class{constructor({period:e,start:t,end:r,selfGrades:o=0}){this.period=e,this.start=new n(t),this.end=new n(r),o&&(this.selfGrades=o.toString(2).split("").reverse().map((e,t)=>"1"===e?s[t]:null).filter(e=>e))}toJSON(){return{period:this.period,start:this.start.totalMinutes,end:this.end.totalMinutes}}}},function(e,t,r){const{schedule1920:n,schedule2021:s}=r(0),o=r(5),i=r(1),d=r(3);class a{constructor(e){this.apiKey=e}year(e,t,r){return new o(this,e,t,r)}static normalSchedule(e){if(n[e])return n[e].map(e=>new d(e));throw new Error("wucky: Only want an integer between 0 and 6 representing a day of the week!")}static get schedule1920(){return JSON.parse(JSON.stringify(n))}static get schedule2021(){return JSON.parse(JSON.stringify(s))}}a.Periods=i,e.exports=a},function(e,t,r){const{KEYWORDS:n,TIME_ZONE_OFFSET:s,CALENDAR_ID:o,defaultSelf:i}=r(2),d=r(6),{schedule1920:a}=r(0),l=r(7),u=r(8),{toDate:p}=r(10);function c(e,t=!1){return new Date(e-(60*(s-(t?24:0))*60*1e3-(t?1:0))).toISOString()}function f({items:e}){const t=[];for(const r of e)if(r.start.dateTime)t.push({summary:r.summary,description:r.description,date:new Date(r.start.dateTime.slice(0,10)).getTime()});else{const e=new Date(r.start.date),n=new Date(r.end.date).getTime();for(;e.getTime()<n;)t.push({summary:r.summary,description:r.description,date:e.getTime()}),e.setUTCDate(e.getUTCDate()+1)}return t}e.exports=class{constructor(e,t,r,{normalSchedule:n=a,calendarId:s=o,defaultSelf:d=i,timeZone:u="America/Los_Angeles"}={}){if(this._gunnSchedule=e,this.firstDay=p(t),this.lastDay=p(r),this._normalSchedule=n,this._parser=new l({defaultSelf:d}),this.lastDay<this.firstDay)throw new Error("wucky: Why would the last day be before the first day???");this._gCalURLBase="https://www.googleapis.com/calendar/v3/calendars/"+encodeURIComponent(s)+"/events?singleEvents=true&fields="+encodeURIComponent("items(description,end(date,dateTime),start(date,dateTime),summary)")+"&key="+e.apiKey+"&timeZone="+u,this._alternates={}}_fetchEvents(e,t,r){return d(`${this._gCalURLBase}&timeMin=${encodeURIComponent(c(e,!1))}&timeMax=${encodeURIComponent(c(t,!0))}${r?"&q="+r:""}`).then(e=>e.ok?e.json():Promise.reject(e)).then(f)}update(e,t){if(t?(e=p(e),t=p(t)):e?(e=p(e),t=e):(e=this.firstDay,t=this.lastDay),t<e)throw new Error("wucky: Why would the end day be before the start day???");return e<this.firstDay&&(e=this.firstDay),t>this.lastDay&&(t=this.lastDay),(e===t?this._fetchEvents(e,t):Promise.all(n.map(r=>this._fetchEvents(e,t,r))).then(e=>[].concat(...e))).then(e=>{const t={};for(const r of e)t[r.date]||(t[r.date]=[]),t[r.date].push(r);for(const[e,r]of Object.entries(t)){const t=this._parser.parseFromEvents(r,new Date(+e).getUTCDay());this._alternates[e]=t||null}})}get(e){return(e=p(e))<this.firstDay||e>this.lastDay?new u({date:e,summer:!0}):this._alternates[e]?new u({date:e,periods:this._alternates[e],alternate:!0}):new u({date:e,periods:this._normalSchedule[new Date(e).getUTCDay()]})}}},function(e,t,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,t.default=n.fetch.bind(n),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},function(e,t,r){const{PASSING_PERIOD_LENGTH:n,newLineRegex:s}=r(2),o=r(0),i=r(1),d=/<\/?(p|div|br).*?>|\),? *(?=[A-Z0-9])/g,a=/<.*?>/g,l=/&nbsp;/g,u=/\(?(1?[0-9])(?::([0-9]{2}))? *(?:am)? *(?:-|â€“) *(1?[0-9])(?::([0-9]{2}))? *(noon|pm)?\)?/,p=/(?:\b|PERIOD)([A-G1-7]|ZERO)\b/,c=/(1?[9012](?:\s*-\s*1?[9012])?)(?:th)?|(freshmen|sophomore|junior|senior|all)/gi,f=/self for (.+?) grade|self for (freshmen|sophomore|junior|senior|all)/gi,h={9:1,10:2,11:4,12:8,freshmen:1,sophomore:2,junior:4,senior:8,all:15};function m({defaultSelf:e}={}){this.defaultSelf=e}m.prototype.getSELFGradesFrom=function(e){let t=0;return e.replace(c,(e,r)=>{if(r&&r.includes("-")){const[e,n]=r.split("-").map(Number);for(let r=e;r<=n;r++)t+=h[r]}else t+=h[r||e]||0}),t},m.prototype.parseFromEvent=function(e,t){if(/schedule|extended|lunch/i.test(e)){if(!t)return null;t="\n"+t.replace(d,"\n").replace(a,"").replace(l," ");const e=[];e._specifiesSELF=!1;for(const r of t.split(s)){let t,s=r.replace(u,(...e)=>(t=e,"")).trim();if(!t)continue;let[o,i,d,a]=t.slice(1,5).map(e=>+e||0);const l="pm"===t[5];(o<6||l)&&(o+=12),(d<6||l)&&(d+=12);let p=60*o+i,c=60*d+a;e.find(e=>{if(e._retire)return!1;if(e.start===p&&e.end===c)return e._raw+="\n"+s,!0;if(e.start<=p&&e.end>=c){s+="\n"+e._raw;const t=p-n,r=c+n;t-e.start>0?e.end=t:e.end-r>0?e.start=r:e._retire=!0}else if(e.start>=p&&e.end<=c){e._raw+="\n"+s;const t=e.start-n,r=e.end+n;if(t-p>0)c=t;else{if(!(c-r>0))return!0;p=r}}})||e.push({_raw:s,start:p,end:c})}const r=e.filter(t=>{if(t._retire)return!1;const r=this.identifyPeriod(t._raw);if(t.period=r,r===i.SELF){e._specifiesSELF=!0,f.lastIndex=0;const r=f.exec(t._raw);t.selfGrades=r&&this.getSELFGradesFrom(r[1]||r[2])||this.defaultSelf}return r}).sort((e,t)=>e.start-t.start);return r.length?r:null}if(/holiday|no\s(students|school)|break|development/i.test(e))return t?null:[]},m.prototype.identifyPeriod=function(e){const t=e.toUpperCase();if(t.includes("PERIOD")){const e=p.exec(t);if(e&&i[e[1]])return i[e[1]]}return t.includes("SELF")?i.SELF:t.includes("MEETING")?i.MEETINGS:t.includes("FLEX")||t.includes("ASSEMBL")||t.includes("ATTEND")||t.includes("TUTORIAL")||t.includes("CAASPP")?i.FLEX:t.includes("BRUNCH")||t.includes("BREAK")?i.BRUNCH:t.includes("UNCH")||t.includes("TURKEY")?i.LUNCH:t.includes("COLLAB")?i.COLLABORATION:t.includes("TOGETHER")?i.GT:null},m.prototype.parseFromEvents=function(e,t){if(0===t||6===t)return null;let r=0,s=null,d=!0;for(const{summary:t="",description:o}of e){if(t.includes("SELF")&&t.includes("grade")){const e=this.getSELFGradesFrom(t);if(e>0){r=e;continue}}if(t.includes("Back-to-School"))continue;if(s)continue;const e=this.parseFromEvent(t,o);if(e){e.specifiesSELF&&(d=!1);for(let t=0;t<e.length;t++){const r=e[t];r.period!==i.BRUNCH&&r.period!==i.LUNCH||(0===t||t===e.length-1?e.splice(t--,1):r.end=e[t+1].start-n)}s=e}}if(s){if(r&&d)for(const e of s)e.period===i.FLEX&&(e.period=i.SELF,e.selfGrades=r);return s}if(4===t?r!==this.defaultSelf:r){const e=JSON.parse(JSON.stringify(o[t]));for(const t of e)t.period!==i.FLEX&&t.period!==i.SELF||(r?(t.period=i.SELF,t.selfGrades=r):t.period=i.FLEX);return e}return null},e.exports=m},function(e,t,r){const n=r(3);e.exports=class{constructor({date:e,periods:t=[],alternate:r=!1,summer:s=!1}){this.date=new Date(e),this.day=this.date.getUTCDay(),this.periods=t.map(e=>new n(e)),this.school=!!this.periods.length,this.alternate=r,this.summer=s}toJSON(){return this.periods.map(e=>e.toJSON())}}},function(e,t){e.exports=class{constructor(e){this.totalMinutes=e,this.hour=Math.floor(e/60),this.minute=e%60}toTime(e=!1){const t=this.minute.toString().padStart(2,"0");return e?`${this.hour}:${t}`:`${(this.hour+11)%12+1}:${t} ${this.hour<12?"am":"pm"}`}}},function(e,t){e.exports={toDate:function(e){return"number"==typeof e?e:e instanceof Date?new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()).getTime():"string"==typeof e&&e.includes("-")?new Date(e).getTime():+e}}}])}));
//# sourceMappingURL=awesome-new-gunn-schedule-package.min.js.map